"use strict";(()=>{var e={};e.id=2,e.ids=[2],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},8893:e=>{e.exports=require("buffer")},4770:e=>{e.exports=require("crypto")},6162:e=>{e.exports=require("stream")},1764:e=>{e.exports=require("util")},9497:(e,r,t)=>{t.r(r),t.d(r,{originalPathname:()=>f,patchFetch:()=>w,requestAsyncStorage:()=>x,routeModule:()=>h,serverHooks:()=>v,staticGenerationAsyncStorage:()=>g});var s={};t.r(s),t.d(s,{POST:()=>m});var a=t(9303),i=t(8716),o=t(3131),n=t(7070),u=t(728),l=t(5456),p=t(5630),c=t(9489);let d=p.Ry({name:p.Z_().min(2,"Name must be at least 2 characters"),email:p.Z_().email("Invalid email address"),password:p.Z_().min(6,"Password must be at least 6 characters"),role:p.Km(["OWNER","SEEKER"]),phone:p.Z_().optional()});async function m(e){try{let r=await e.json(),t=d.parse(r);if(await u._.user.findUnique({where:{email:t.email}}))return n.NextResponse.json({success:!1,error:"User already exists with this email"},{status:400});let s=await (0,l.c_)(t.password),a=await u._.user.create({data:{name:t.name,email:t.email,password:s,role:t.role,phone:t.phone},select:{id:!0,name:!0,email:!0,role:!0,phone:!0,avatar:!0,createdAt:!0,updatedAt:!0}}),i=(0,l.RA)({userId:a.id,email:a.email,role:a.role}),o=n.NextResponse.json({success:!0,data:{user:a,token:i},message:"User registered successfully"});return o.cookies.set("token",i,{httpOnly:!0,secure:!0,sameSite:"strict",maxAge:604800}),o}catch(e){if(console.error("Registration error:",e),e instanceof c.j)return n.NextResponse.json({success:!1,error:e.issues[0]?.message||"Validation error"},{status:400});return n.NextResponse.json({success:!1,error:"Internal server error"},{status:500})}}let h=new a.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/auth/register/route",pathname:"/api/auth/register",filename:"route",bundlePath:"app/api/auth/register/route"},resolvedPagePath:"C:\\Users\\HP\\Downloads\\task_project\\project\\src\\app\\api\\auth\\register\\route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:x,staticGenerationAsyncStorage:g,serverHooks:v}=h,f="/api/auth/register/route";function w(){return(0,o.patchFetch)({serverHooks:v,staticGenerationAsyncStorage:g})}},5456:(e,r,t)=>{t.d(r,{Oe:()=>l,RA:()=>p,WX:()=>c,c_:()=>u});var s=t(1482),a=t.n(s),i=t(2023),o=t.n(i);let n=process.env.JWT_SECRET||"fallback-secret-key",u=async e=>o().hash(e,12),l=async(e,r)=>o().compare(e,r),p=e=>a().sign(e,n,{expiresIn:"7d"}),c=e=>{try{return a().verify(e,n)}catch(e){return null}}},728:(e,r,t)=>{t.d(r,{_:()=>a});let s=require("@prisma/client"),a=globalThis.prisma??new s.PrismaClient}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[276,39],()=>t(9497));module.exports=s})();