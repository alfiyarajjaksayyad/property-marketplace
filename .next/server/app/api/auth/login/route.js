"use strict";(()=>{var e={};e.id=873,e.ids=[873],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},8893:e=>{e.exports=require("buffer")},4770:e=>{e.exports=require("crypto")},6162:e=>{e.exports=require("stream")},1764:e=>{e.exports=require("util")},8542:(e,r,s)=>{s.r(r),s.d(r,{originalPathname:()=>f,patchFetch:()=>w,requestAsyncStorage:()=>g,routeModule:()=>h,serverHooks:()=>v,staticGenerationAsyncStorage:()=>x});var t={};s.r(t),s.d(t,{POST:()=>m});var a=s(9303),o=s(8716),i=s(3131),n=s(7070),u=s(728),p=s(5456),l=s(5630),c=s(9489);let d=l.Ry({email:l.Z_().email("Invalid email address"),password:l.Z_().min(1,"Password is required")});async function m(e){try{let r=await e.json(),s=d.parse(r),t=await u._.user.findUnique({where:{email:s.email}});if(!t||!await (0,p.Oe)(s.password,t.password))return n.NextResponse.json({success:!1,error:"Invalid email or password"},{status:401});let a=(0,p.RA)({userId:t.id,email:t.email,role:t.role}),{password:o,...i}=t,l=n.NextResponse.json({success:!0,data:{user:i,token:a},message:"Login successful"});return l.cookies.set("token",a,{httpOnly:!0,secure:!0,sameSite:"strict",maxAge:604800}),l}catch(e){if(console.error("Login error:",e),e instanceof c.j)return n.NextResponse.json({success:!1,error:e.issues?.[0]?.message||"Validation error"},{status:400});return n.NextResponse.json({success:!1,error:"Internal server error"},{status:500})}}let h=new a.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/auth/login/route",pathname:"/api/auth/login",filename:"route",bundlePath:"app/api/auth/login/route"},resolvedPagePath:"C:\\Users\\HP\\Downloads\\task_project\\project\\src\\app\\api\\auth\\login\\route.ts",nextConfigOutput:"",userland:t}),{requestAsyncStorage:g,staticGenerationAsyncStorage:x,serverHooks:v}=h,f="/api/auth/login/route";function w(){return(0,i.patchFetch)({serverHooks:v,staticGenerationAsyncStorage:x})}},5456:(e,r,s)=>{s.d(r,{Oe:()=>p,RA:()=>l,WX:()=>c,c_:()=>u});var t=s(1482),a=s.n(t),o=s(2023),i=s.n(o);let n=process.env.JWT_SECRET||"fallback-secret-key",u=async e=>i().hash(e,12),p=async(e,r)=>i().compare(e,r),l=e=>a().sign(e,n,{expiresIn:"7d"}),c=e=>{try{return a().verify(e,n)}catch(e){return null}}},728:(e,r,s)=>{s.d(r,{_:()=>a});let t=require("@prisma/client"),a=globalThis.prisma??new t.PrismaClient}};var r=require("../../../../webpack-runtime.js");r.C(e);var s=e=>r(r.s=e),t=r.X(0,[276,39],()=>s(8542));module.exports=t})();